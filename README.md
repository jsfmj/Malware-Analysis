# Malware-Analysis

This project focuses on analyzing and reverse engineering malware samples to uncover their behavior and potential threats. The analysis was conducted using a variety of tools to extract valuable insights from obfuscated malware and packed executables.

Used tools such as HxD, HashMyFiles, Xorsearch, Exeinfo PE and floss for static malware analysis. 
Used tools such as wireshark, regshot and procmon for dynamic malware analysis.

Project Goals: The goal of this project is to provide a deeper understanding of how malware operates, how it obfuscates its actions, and how to extract meaningful insights from such samples to better protect systems from malicious threats.

Static analysis

Malware that is being used for static analysis
<img width="786" alt="Malware" src="https://github.com/user-attachments/assets/fd7e1a1c-a368-49b4-82de-1d02cc59c75c">



Checking to see if the file is an executable or not using HxD. If the keywords 4D 5A MZ and "This program cannot be run in DOS mode" exists, the file is an executable
<img width="1470" alt="Checking if the file is an executable" src="https://github.com/user-attachments/assets/30cf7400-eeac-4aaa-8b81-4837a1b37de9">



Finding the hash of the file using HashMyFiles
<img width="1470" alt="Finding the hash of the malware" src="https://github.com/user-attachments/assets/26c905c2-e0da-4420-a034-63cca994dff7">



Putting the hash in virustotal for analysis
<img width="1448" alt="Virustotal" src="https://github.com/user-attachments/assets/23fd27e3-57ff-4037-aeb8-82660e272c8c">



Summary and details of the analysis
<img width="1455" alt="Virustotal summary" src="https://github.com/user-attachments/assets/46880bfd-6fa3-4bb3-9ffb-2c0948e3bb6e">
<img width="1453" alt="Virustotal details" src="https://github.com/user-attachments/assets/5d61e115-98a3-417e-a7d1-ffb99ff345a3">



Finding string above 10 characters in the malware file using strings command
<img width="972" alt="Strings command" src="https://github.com/user-attachments/assets/28cf1a4c-d16c-450d-af20-d1274034a45e">



Finding specific strings that might be obfuscated using Xorsearch command. In this case we are looking for strings starting with "http" and "This"
<img width="977" alt="Xorsearch command" src="https://github.com/user-attachments/assets/c54640fe-9716-484f-8ab7-73afc05026dc">



Finding static and obfuscated strings using floss
<img width="977" alt="floss static strings" src="https://github.com/user-attachments/assets/45204084-de8a-45ce-aca1-7b346198733f">
<img width="974" alt="floss command" src="https://github.com/user-attachments/assets/9b1ca4ac-88b1-46cd-aa34-8195bc71568e">



Finding the packing info of the malware using Exeinfo PE
<img width="538" alt="exeinfo pe" src="https://github.com/user-attachments/assets/4f21f36d-94cd-4b7d-b7ec-92f2bf188d44">


Dynamic analysis

Taking the shot of the system before running the malware
<img width="717" alt="Regshot 1st" src="https://github.com/user-attachments/assets/9cb8607e-c894-42a0-88e0-ccb0e2f1e801">



Running the malware
<img width="1110" alt="Running the malware" src="https://github.com/user-attachments/assets/fa263827-b010-4619-b004-f5f3c7810976">



Looking at the process tree in procmon to see what the malware is doing
<img width="1074" alt="Process tree in procmon" src="https://github.com/user-attachments/assets/be82eb8f-cff5-4ffc-930f-ca323cd652f8">



Filtering wireshark for SNMP, http and DNS to see if the malware tried to establish external connection
<img width="1470" alt="Wireshark" src="https://github.com/user-attachments/assets/a582edb4-d920-4dd1-9dc9-3dfc381992de">



Taking the shot of the system after running the malware
<img width="645" alt="Regshot compare" src="https://github.com/user-attachments/assets/eef63d56-9699-46c0-8853-b4ff8c412144">



Comparing the first and second shot to see what has changed. In particular looking for keys added to see if the malware has added anything to the system
<img width="1093" alt="Added keys" src="https://github.com/user-attachments/assets/89bb556c-762b-40f4-be20-17827857e2e3">













